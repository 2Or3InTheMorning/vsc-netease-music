<!DOCTYPE html>
<html>
    Please preserve this webview tab
    <script>
        const audio = new Audio()
        const vscode = acquireVsCodeApi()
        const postMessage = (type, body) => vscode.postMessage({type, body})
        let playing = {}

        audio.addEventListener('play', () => {
            postMessage('event', {name: 'play'})
        }, false)

        audio.addEventListener('pause', () => {
            postMessage('event', {name: 'pause'})
        }, false)

        audio.addEventListener('ended', () => {
            postMessage('event', {name: 'end'})
        }, false)

        audio.addEventListener('loadstart', () => {
            postMessage('event', {name: 'load', data: playing})
        }, false)

        window.addEventListener('message', event => {
            const message = event.data
            if(message.command === 'load'){
                audio.src = message.data.url
                playing = message.data
                // postMessage('log',`ok i load ${message.data.url}`)
            }
            else if(message.command === 'play'){
                if(audio.paused) audio.play()
            }
            else if(message.command === 'pause'){
                if(!audio.paused) audio.pause()
            }
        })
    </script>
</html>